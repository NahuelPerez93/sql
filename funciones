DELIMITER $$

CREATE FUNCTION 
calcular_total_pedido
(p_id_pedido INT) 
RETURNS DECIMAL(10, 2)
READS SQL DATA
BEGIN
    DECLARE v_total DECIMAL(10, 2);

    SELECT SUM(DP.CANTIDAD * DP.PRECIO_UNITARIO) INTO v_total
    FROM fabrica_de_valvulas.Detalle_del_pedido DP
    WHERE DP.ID_PEDIDO = p_id_pedido;

    RETURN v_total;
END $$

DELIMITER ;

DELIMITER $$
CREATE PROCEDURE 
actualizar_precio_material
(IN p_id_material INT, IN p_nuevo_precio DECIMAL(10, 2))
BEGIN
    UPDATE Materiales
    SET PRECIO = p_nuevo_precio
    WHERE ID_MATERIALES = p_id_material;
END $$

DELIMITER ;



SELECT*FROM materiales;
CALL actualizar_precio_material(2, 55.99);

SELECT*FROM pedidos;
SELECT calcular_total_pedido(262);
